stages:
  - deploy

deploy_to_ec2:
  stage: deploy
  image: alpine:latest

  before_script:
    - apk add --no-cache openssh bash

  script:
  - echo "ðŸš€ Deploying to EC2..."
  - ssh -o StrictHostKeyChecking=no -i "$EC2_KEY" $EC2_USER@$EC2_HOST '
      if [ ! -d "sem3-template" ]; then
        git clone https://gitlab.com/Cancani/sem3-template.git
      fi &&
      cd sem3-template &&
      git pull &&
      bash restart.sh
    '

      "

  only:
    - main
